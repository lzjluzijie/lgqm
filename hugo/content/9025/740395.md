---
aid: 9025
zid: 740395
title: '【转贴】Linux如何运行于8位AVR微控制器？'
author: 钟利时
date: 2018-02-27 19:33:41+07:00
lastmod: 2018-09-29 12:27:00+07:00
---



钟利时 于 2018-2-27 19:33:41 发表了：

 _本帖最后由 钟利时 于 2018-2-27 19:38 编辑_   

此文可以作为临高未来复刻计算机的一个参考。（我是跪着看完的）  

Linux如何运行于8位AVR微控制器？   

作者：德米特里·格林伯格  

&nbsp; &nbsp;&nbsp; &nbsp;更新记录2  

太平洋夏令时（PDT），2012年4月3日凌晨1点：上传了新的源代码存档；使用内存的FPM（Fast Page   

Mode，快页模式）模式和修改后的i-cache（指令缓存）配置文件加快了仿真器频率（6.5KHz-&gt;10KHz）；更新了移植指南，包括内核镜像、新的更小的ramdisk（虚拟磁盘）和新的完整镜像。  

&nbsp; &nbsp;&nbsp; &nbsp;更新记录1  

&nbsp; &nbsp;&nbsp; &nbsp;  

太平洋夏令时（PDT），2012年3月29日晚19点：上传了新的源代码存档；修改了Makefile，并且现在包含了一个移植指南，它可以帮助您将它移植到其他的开发板或CPU中。  










**222256.jpg** _(28.79 KB, 下载次数: 0)_


下载附件

&nbsp;
保存到相册


2018-2-27 19:27 上传











&nbsp; &nbsp;&nbsp; &nbsp;简介  

&nbsp; &nbsp;&nbsp; &nbsp;  

我们经常可以看到初学者在微控制器论坛中询问他们是否可以在他们微不足道的小的8位微机中运行Linux。这些问题的结果通常是带来笑声。我们也经常看到，在Linux论坛中，询问Linux运行的最低要求是什么。常见的答案是Linux需要一个32位架构和一个MMU（存储器管理单元），并至少1MB的RAM来满足内核的需求。本项旨在（并且成功）粉碎这些概念。下图中您所看到的开发板基于ATmega1284P。我还制作了一块基于ATmega644a的开发板，也同样获得了成功。该开发板没有使用其他处理器，启动Linuxx  

2.6.34内核。事实上，它甚至可以运行一个完整的Ubuntu栈，包括X（如果你有时间等它启动）和gnome。  

&nbsp; &nbsp;&nbsp; &nbsp;RAM（随即存取存储器）  

&nbsp; &nbsp;&nbsp; &nbsp;  

是的，没错，完整的Linux安装需要数兆字节的RAM和32位带有MMU的CPU。本项目拥有这一切。首先，让我们访问RAM。正如您所看到的，在电路中有一块古董级的30引脚SIMM内存模块。这些是基于80286的PC曾经使用的。它通过接口和ATmega连接，我写代码来访问它并按照规格刷新它（SDRAM需要恒定速率刷新以避免丢失数据）。它到底有多快呢？刷新中断每62ms发生一次，占用时间1.5ms，因此占用3%以下的CPU。访问RAM，为了便于编程，一次访问一个字节。这样产生的最大带宽约为300KBps。  










**222257.jpg** _(28.54 KB, 下载次数: 0)_


下载附件

&nbsp;
保存到相册


2018-2-27 19:27 上传











&nbsp; &nbsp;&nbsp; &nbsp;存储  

&nbsp; &nbsp;&nbsp; &nbsp;  

对于RAM需要工作在休眠状态，我们有两件事要处理。存储并不是太难解决的问题。使用SPI可以十分容易的与SD卡交互，我的项目中做到了这一点。一个1GB的SD卡可以工作的很好，虽然512MB就已经满足这一特殊的文件系统（Ubuntu夏  

Jaunty）。ATmega拥有一个硬件SPI模块，但无论出于何种原因，它工作的不是十分顺畅，因此我将这个接口进行位拆裂。它仍然足够块——大约200KBps。这对项目来说还非常有意义——它能够在有足够管脚的任何微控制器上实现，而不用使用其他硬件模块。  










**222258.jpg** _(35.29 KB, 下载次数: 0)_


下载附件

&nbsp;
保存到相册


2018-2-27 19:27 上传











&nbsp; &nbsp;&nbsp; &nbsp;CPU（中央处理单元）  

&nbsp; &nbsp;&nbsp; &nbsp;  

所有剩下的就是那个32位CPU和MMU需求。不过AVR没有MMU，并且它是8位的。为了克服这一困难，我编写了一款ARM仿真器。ARM是我最熟悉的架构，并且它足够简单，可以让我很舒服的为它编写出一个仿真器。为什么要编写一个，而不是移植一个呢？好吧，移植别人的代码是没有乐趣的，再加上我看到没有将仿真器轻松移植到8位设备上的书面资料。原因之一：AVR编译器坚持16位处理整数将会给你带来麻烦，如简单的“（1&lt;&lt;20）”，产生0。你需要用“1UL&lt;&lt;20”。不必要的说，困扰其他人的未知基本代码寻遍所有的地方，整数都被假定并将会失败，这将是一个灾难。另外，我想用这个机会编写一款很好的模块化ARM仿真器。所以我付诸行动。  

&nbsp; &nbsp;&nbsp; &nbsp;其他功能  

&nbsp; &nbsp;&nbsp; &nbsp;  

电路板通过一个串行端口和真实世界进行通信。目前，它通过串行端口连接到我PC运行的minicom上，但是它可测的替代连接是连接到电路上的一个键盘和一个字符LCD，可以使其完全独立。电路板上还有两个LED。它们指示SD卡的访问情况。一个代表读操作，一个代表写操作。电路板上还有一个按钮。当按下并按住1秒时它将使串行端口脱离仿真的CPU的当前有效速度。AVR的主频是24MHz（超过原有20MHz的轻微超频）。  

&nbsp; &nbsp;&nbsp; &nbsp;它的速度有多快？  

&nbsp; &nbsp;&nbsp; &nbsp;  

uARM肯定没有速率守护进程。它花了大约2个小时启动到BASH提示符（"init=/bin/bash"内核命令行）。然后用4个多小时启动整个Ubuntu（"exec）  

init"然后登陆）。启动X将消耗更长时间。有效的仿真CPU速度约为6.5KHz，这与你期望的在一个可怜的8位微控制器上仿真一个32位CPU和MMU是同等的水平。奇怪的是，一旦启动，该系统是有些可用的。您可以输入一个命令，并在一分钟之内得到答复。也就是说实际上你是可以使用它的。比如，今天我还用它来格式化我的SD卡。这绝对不是最快的，但我觉得它可能是最便宜、最慢、最简单的手工组装、最低的部件数量以及最低端的LinuxU  

PC。电路板是使用导线手工焊接的，甚至没有使用印刷电路板（PCB）的必要。  

&nbsp; &nbsp;&nbsp; &nbsp;仿真器的细节？  

&nbsp; &nbsp;&nbsp; &nbsp;  

仿真器是相当模块化的，允许它随意扩展仿真其他SoC（片上系统）和硬件配置。仿真的CPU是ARMv5TE。前一段时间，我开始进行支持ARMv6的工作，但是一直没有完成（从代码中可以看出来），因为不是很需要。仿真的SoC是PXA255。由于模块化的设计，你可以替换SoC.c文件，并使用相同的ARMv5TE核心编译一个完整的新的SoC，或者替换核心，或者按照意愿替换外设。这是有目的的，我的意思是这个代码也是一个关于ARM简  

SoC如何工作的相当整洁的范例。CPU仿真器自身的代码并不是太整洁，那么，好吧，它是一个CPU模拟器。这是几年前花了超过6个月的空闲时间写的，然后就放在一边了。它最近复活是专门为了这个项目。仿真器实现了i-cache来提高速度。这给予了AVR很多帮助，使内部存储器能够以超过每秒5MB的速率访问，而不像我的外部RAM。我还没有抽出时间去实现d-cache（数据缓存），但是这已经在我的待办事项列表上了。访问块设备没有被仿真为SD设备。事实证明这太慢了。取而代之的是一个准虚拟化磁盘设备（pvdisk，参见pvDisk.tar.bz2，GPL许可证），我编写的时候使用了一个无效的操作码来调入仿真器并访问磁盘。我的镜像中的ramdisk（虚拟磁盘）加载这个pvdisk，然后改变根目录到/dev/pvd1。ramdisk被包含在了“rd.img”中。我使用的“机器类型”是PalmTE2。为什么？因为我非常熟悉这款硬件，它是我见到的第一款PXA255机器类型。  

&nbsp; &nbsp;&nbsp; &nbsp;Hypercall（超级调用）？  

&nbsp; &nbsp;&nbsp; &nbsp;  

有一些服务你可以通过使用一个特殊的操作码向仿真器发出请求。在ARM中它是0xF7BBBBBB，在Thumb中它是0xBBBB。挑选这些是由于它们所在的范围ARM保证是未定义的。超级调用号码通过寄存器R12被传递，参数通过寄存器R0-R3被传递，返回值被放置在R0中。  

&nbsp; &nbsp;&nbsp; &nbsp;调用：  

&nbsp;&nbsp;0 = 停止仿真  

&nbsp;&nbsp;1 = 打印十进制数  

&nbsp;&nbsp;2 = 打印字符  

&nbsp;&nbsp;3 = 获取RAM大小  

&nbsp;&nbsp;4 = 块设备操作（R0 = 操作，R1 =   

&nbsp;&nbsp;扇区(sector)号）。请注意，这些不写入仿真的RAM，它们使用另一个超级调用填充了仿真用户访问的仿真器内部缓冲区，一次一个字。我的意思是实现DMA，但是还没有抽出时间去做。操作：  

&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; 0 = 获取信息（如果扇区号是0，返回扇区的数量；如果扇区号是1，以字节位单位返回扇区大小）  

&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; 1 = 扇区读取  

&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; 2 = 扇区写入  

&nbsp;&nbsp;5 = 块设备缓冲区访问（R0 = 值输入/值输出，R1 = 字数，R2 = 如果写入为1，其他情况为0）  

&nbsp; &nbsp;&nbsp; &nbsp;Thumb支持？  

&nbsp; &nbsp;&nbsp; &nbsp;  

完全支持Thumb。我欺骗了一下，解码每个Thumb指令字符串（instr）为等价的ARM指令字符串并执行，以此代替使用ARM仿真器函数。它不像它原来一样快，但是它简单并且代码小巧。可以使用256KB的查找表，但是我感觉256KB对于微控制器的闪存来说太大了。一些Thumb指令不能被转换为ARM指令，它们被正确处理代替。  

&nbsp; &nbsp;&nbsp; &nbsp;我想要建立一个！  

&nbsp; &nbsp;&nbsp; &nbsp;用于非商业目的，你肯定可以做到这一点。接线方式如下：  

&nbsp;&nbsp;RAM的DQ0-DQ7连接AVR的C0-C7；  

&nbsp;&nbsp;RAM的A0-A7连接AVR的A0-A7；  

&nbsp;&nbsp;RAM的A8-A11连接AVR的B0-B3；  

&nbsp;&nbsp;RAM的nRAM nRAS nCAS nWE连接AVR的D7 B4 B5；  

&nbsp;&nbsp;SD的DI SCK DO连接AVR的B6 B7 D6；  

&nbsp;&nbsp;LED的read write连接AVR的D2 D3（LED的其他管脚接地）；  

&nbsp;&nbsp;按钮连接AVR的D4（其他管脚接地）。  

&nbsp; &nbsp;&nbsp; &nbsp;  

RAM可以是任何30引脚的16MB的SIMM，可以运行在每64毫秒4000个周期的CAS-before-RAS刷新频率下。我使用的（OWC）可以花几块钱在网上买到。原理图显示在这里，点击它查看大图或点击这里。  

&nbsp; &nbsp;&nbsp; &nbsp;源代码？  

&nbsp; &nbsp;&nbsp; &nbsp;  

这个代码有点儿乱，但是它可以工作。点击这里下载。许可证简单：用于非商业用途，只要你保留原有的许可证文件和源代码一起，并发布所有你的改动，那么我们都很酷！用于商业用途，请和我联系，我们将在一些事情上达成一致。要在PC上建立仿真器并进行尝试输入“make”。要运行使用“./uARM止  

DISK_IMAGE”。要建立优化的PC版本使用“make BUILD=opt”。要建立AVR运行的版本使用“make   

BUILD=avr”。现在，它的编译目标是ATmega1284P。要以ATmega644为编译目标，除了要修改makefile，减少icache.h中的数字以便于i-cache足够小来配合644内部的RAM。在归档文件中还包括用于1284p最终的hex文件。  

&nbsp; &nbsp;&nbsp; &nbsp;启动过程  

&nbsp; &nbsp;&nbsp; &nbsp;  

要在AVR中保留代码空间，几乎没有启动代码存在于仿真器中。事实上，“ROM”总共50字节：8字节用来选择Thumb模式，一些Thumb代码要读取SD卡的第一个扇区并跳到Thumb模式（参看embeddedBoot.c）。SD卡的MBR有另一个bootloader（在Thumb模式下写入）。这个bootloader看着MBR，找到活动分区并加载它的内容到RAM的末尾。然后，它跳到目的RAM地址+512（参看mbrBoot.c）。这里运行着第三个，也是最大的bootloader，ELLE（参看ELLE.c）。这个bootloader重新定位了ramdisk，建立ATAGS，并调用内核。我提供了所有的二进制文件和源代码以便于大家能够按照意愿制作您自己镜像。启动过程会让人回忆起PC开机。:)包含的mkbooting.sh工具可以用来制作用于启动分区的工作镜像。一个完整的磁盘镜像？请点击：第一版镜像，第二版镜像。  

&nbsp; &nbsp;&nbsp; &nbsp;视频  

&nbsp; &nbsp;&nbsp; &nbsp;  

原始视频分为几个片段，因为我在录像时不得不更换几次照相机电池。然后，我把它们拼接在一起，创建了巨大的3个半小时时长的视频。视频的未剪辑版本？点击这里。然后我剪辑出有意思的部分，把它们加快了3倍（来适合YouTube视频长度限制）并制作了这段视频。在视频中可以看到一个时钟，显示从开始算起消耗的时间。  










**222260.png** _(128.92 KB, 下载次数: 0)_


下载附件
 
&nbsp;
保存到相册


2018-2-27 19:27 上传











  

---------


ss0070 于 2018-2-27 19:58:03 发表了：

这也太牛了……  

---------


RSE 于 2018-2-27 20:04:57 发表了：

把内存直接焊上了？这内存不就废了吗

---------


相空月 于 2018-2-27 20:10:55 发表了：

计算机专业表示看的脑阔疼。  

---------


aszxdcgok 于 2018-2-27 20:18:28 发表了：

这个很硬啊  

---------


深潜者 于 2018-2-27 20:22:28 发表了：

毫不逊色于用继电器Cosplay计算机的大神

---------


深潜者 于 2018-2-27 20:24:08 发表了：

话说对于临高来说，需要研究的应该是用什么软件在电脑上尽可能低成本的运行几百甚至更多个电传打字机级用户吧？

---------


cc52333 于 2018-2-27 20:51:25 发表了：


> 
> 
> 深潜者 发表于 2018-2-27 20:24
>  
> 
> 
> 
>   
> 
> 话说对于临高来说，需要研究的应该是用什么软件在电脑上尽可能低成本的运行几百甚至更多个电传打字机级用户 ...
  

这个是不是跟银行目前很多模式一样的？  

---------


rottenweed 于 2018-2-27 20:55:39 发表了：

宁可用μCOS吧，太折腾了。  

---------


深潜者 于 2018-2-27 21:00:01 发表了：


> 
> cc52333 发表于 2018-2-27 20:51
>   
> 
> 
> 这个是不是跟银行目前很多模式一样的？
> 
  

差不多吧？相对来说，电传打字机是临高能实现的最简单输入输出设备了。而且它的功能也算是比较强大的了。临高现存的计算机好好保管的话，支持几十年也是可能的。大约得一直发展到集成电路时代，自产的计算机们才有可能在总计算力上与残存的旧时空计算机比肩。因此用旧时空计算机支持哑终端的时代应该会持续很久很久。

---------


没事乱溜达 于 2018-2-27 21:18:46 发表了：

楼主跪了多久？

---------


cc52333 于 2018-2-27 21:52:24 发表了：


> 
> 
> 深潜者 发表于 2018-2-27 21:00
>  
> 
> 
> 
>   
> 
> 差不多吧？相对来说，电传打字机是临高能实现的最简单输入输出设备了。而且它的功能也算是比较强大的了。 ...
  

那我觉得这个模式实现并不困难啊，现成例子很多。而且很多服务器都用了非常长的年限。。  

---------


深潜者 于 2018-2-27 22:22:53 发表了：


> 
> cc52333 发表于 2018-2-27 21:52
>   
> 
> 
> 那我觉得这个模式实现并不困难啊，现成例子很多。而且很多服务器都用了非常长的年限。。  
> 
> ...
> 
  

八位的服务器没有呀

---------


cc52333 于 2018-2-28 00:56:08 发表了：


> 
> 
> 深潜者 发表于 2018-2-27 22:22
>  
> 
> 
> 
>   
> 
> 八位的服务器没有呀
  

按钟博士这个文，8位也可以搞出来。  

服务器就是个强点硬件啊。但是20几年前的硬件现在算个啥。。  

---------


某食肉动物2 于 2018-9-17 20:56:24 发表了：

最近为了肝活在看RISC指令集相关，突然想起这个文  

有一个想法，在临高穿越的时代 arduino开发板已经开始在国内外的开源圈子流行  

加上这篇文章的想法我们是不是可以考虑用这个做一个极其简化的tinyPC  

---------


Avo17000 于 2018-9-17 21:57:08 发表了：

楼上元老们设想的电传打字机我觉得是对的，暂时狒狒们也不需要更高档的玩意了。我曾经设想过狒狒们在两广战役中采用以电报为主干的通讯体系就有电传打字机。各占领区内或用电报，或用人力方式逐日发送情况汇报。其中的后勤信息就在汇总后发送给广州和香港，再汇总发给临高。香港总后勤基地里，每天的电传打字机响个不停，洪元老每天就看着不断更新的巨型看板做出重要指示。

---------


wizardtong 于 2018-9-17 22:56:57 发表了：

 _本帖最后由 wizardtong 于 2018-9-17 23:08 编辑_   

这种单片机还是老老实实开发成专用计算机跑汇编得了，是做工业控制的，开发的时候都是一个字节一个字节省着用，上面说做打字机就挺好的，Linux太浪费了吧，而且你把他弄成通用计算机是想干啥。

---------


没事乱溜达 于 2018-9-18 09:25:04 发表了：


> 
> wizardtong 发表于 2018-9-17 22:56
>   
> 
> 
> 这种单片机还是老老实实开发成专用计算机跑汇编得了，是做工业控制的，开发的时候都是一个字节一个字节省着 ...
> 
  

看片

---------


没事乱溜达 于 2018-9-18 09:25:44 发表了：

坏了，跟坟了

---------


以一敌七 于 2018-9-18 10:12:34 发表了：

这东西没用，500废哪有那个水平去开发、维护这些啊，买上几万片386或者M4之类的CPU，充氮气保存起来，更合算，好歹会的人还比较多。

---------


lxr 于 2018-9-18 12:16:34 发表了：

386即使10年前也太老了吧？还能买到新货吗？

---------


wizardtong 于 2018-9-18 12:37:09 发表了：


> 
> 
> 
> 没事乱溜达 发表于 2018-9-18 09:25
> 
> 
>   
> 
> 看片
  

不是说了是8位的AVR ATMEGE128,贴里的方案还扩展了ram，临高哪有ram可以用

---------


cc5233 于 2018-9-18 13:06:06 发表了：


> 
> 
> lxr 发表于 2018-9-18 12:16
>  
> 
> 
> 
>   
> 
> 386即使10年前也太老了吧？还能买到新货吗？
  

类似产品或者类似性能可以买的。  

开发靠自己问题不大，因为我们不需要面对复杂的客户需求，基本上就是码农写什么，用户用什么。  

考虑到基层普及能力显然属于天方夜谭，所以真正用户群体完全可以接受这种设定。  

  

---------


没事乱溜达 于 2018-9-18 13:16:29 发表了：


> 
> wizardtong 发表于 2018-9-18 12:37
>   
> 
> 
> 不是说了是8位的AVR ATMEGE128,贴里的方案还扩展了ram，临高哪有ram可以用
> 
  

当然是带去了。  

重新发展科技树的时候直接放弃wintel

---------


wizardtong 于 2018-9-18 13:50:19 发表了：


> 
> 
> 
> 没事乱溜达 发表于 2018-9-18 13:16
> 
> 
>   
> 
> 当然是带去了。  
> 
> 重新发展科技树的时候直接放弃wintel
  

那还不如在原时空采购装配好的，还便宜  

---------


没事乱溜达 于 2018-9-18 14:13:29 发表了：


> 
> wizardtong 发表于 2018-9-18 13:50
>   
> 
> 
> 那还不如在原时空采购装配好的，还便宜
> 
  

这个更省。  

楼主是跪着看完的。我还跪着呢。。。。

---------


lxr 于 2018-9-18 14:59:56 发表了：

意思是不是用这个8位的U运行一个虚拟机，虚拟机则运行一个LINUX系统？  

这个系统能运行，但速度有点儿慢，启动时间只用了六个小时。

---------


某食肉动物2 于 2018-9-18 15:03:06 发表了：


> 
> 
> 
> lxr 发表于 2018-9-18 14:59
> 
> 
>   
> 
> 意思是不是用这个8位的U运行一个虚拟机，虚拟机则运行一个LINUX系统？  
> 
> 这个系统能运行，但速度有点儿慢，启 ...
  

差不多这个意思，但是其实可以做进一步的简化==  

顺带时钟频率以及其他诸多方面都还有很大的提升空间啊  

---------


lxr 于 2018-9-18 15:13:54 发表了：

能不能做个编译器，直接编译LINUX源码在这个8位U上运行？这样起码运行效率会高许多。

---------


liutom2 于 2018-9-18 16:11:27 发表了：


> 
> 
> 
> lxr 发表于 2018-9-18 15:13
> 
> 
>   
> 
> 能不能做个编译器，直接编译LINUX源码在这个8位U上运行？这样起码运行效率会高许多。 ...
  

应该是不行的，这个8位CPU的资源不够，所以搞了一个外挂的内存，这个外挂内存应该只能用虚拟机跑，直接编译的没法用  

---------


Scat 于 2018-9-18 16:58:52 发表了：

髡贼能造1g的闪存得哪年了，登月肯定ok了

---------


没事乱溜达 于 2018-9-18 18:40:27 发表了：


> 
> 
> 
> Scat 发表于 2018-9-18 16:58
> 
> 
>   
> 
> 髡贼能造1g的闪存得哪年了，登月肯定ok了
  

不是单纯的制造内存  

这东西给了一个电脑替代品的廉价方案思路.............非常廉价  

  

---------


wizardtong 于 2018-9-24 16:26:11 发表了：


> 
> 
> 
> lxr 发表于 2018-9-18 15:13
> 
> 
>   
> 
> 能不能做个编译器，直接编译LINUX源码在这个8位U上运行？这样起码运行效率会高许多。 ...
  

干脆自己开发个类似与basic的系统，要啥Linux  

---------


一路向上 于 2018-9-24 17:54:34 发表了：

 _本帖最后由 一路向上 于 2018-9-24 17:56 编辑_   

美帝的马克一号，还有德棍的Z1，Z3。这种机电式，以继电器，电容为核心的全自动计算机才是临高短期内能复现的吧？  

---------


钟利时 于 2018-9-25 04:50:49 发表了：


> 
> 
> 
> 一路向上 发表于 2018-9-24 17:54
> 
> 
>   
> 
> 美帝的马克一号，还有德棍的Z1，Z3。这种机电式，以继电器，电容为核心的全自动计算机才是临高短期内能复现 ...
  

我一直建议首先搞机电式计算机。  

但我们初期可以在机电式计算机上开个金手指——用单片机实现机电计算机的处理器、内存部分。因为这两个部分是最复杂、最影响速度的地方。  

在穿越时，可以带上一些单片机继电器系统板，而不是单片机芯片。系统板上不仅有单片机芯片，还有必须的晶振、继电器接口的二极管。这些我们很长时间内都无法制造。系统板通过继电器输入输出。有两种电压（36V直流发电机电源用于继电器电路；4～4.8V铅酸蓄电池电源用于单片机数字电路）  

一个标准托盘那么大的空间（W 1m×L 0.8m×H 2m）可以装1600盒这种系统板。每块系统板多配若干块单片机，用于刷不同的程序。  

这种单片机+继电器混合电脑比ENIAC性能可强悍多了。  

这种计算机需要解决的几个关键设备：  

（1）纸带读写机：由单片机组成。可通过串口与主机通信。  

（2）电传打字机：由单片机组成。可利用纸带输入、输出，并可通过串口与主机通信。电传打字机是我们在CRT出现之前唯一能制造的可视化输入、输出设备。我们初期能造的电传打字机只能是字模式英文打字机。点阵式汉字打字机需要至少256KB字库，对原始计算机来说这是非常吓人的存储空间。  

（3）纸带编程器：由单片机组成。可通过打孔纸带输入，为另一片单片机芯片编程。也可以将另一片单片机的程序读出来输出为纸带。一旦解决纸带编程器，可以不用珍贵的PC为单片机编程。  

单片机还有动态加载问题：单片机很多是哈佛结构，指令和数据存储分开，程序一次烧写在EEPROM里。很难像冯诺依曼结构那样将指令动态加载。  

解决这个问题的方法：  

（1）设计一个中间语言解释器（类似JVM）。单片机里刷的是解释器。在系统板上需要一个足够大的外部RAM，或者在单片机选型时选择数据内存64KB的型号。解释器估计在4KB～8KB。  

（2）每块系统板多配一些单片机芯片，系统板使用ZIF插座。多余的单片机芯片刷上不同的常用程序，减少重新编程的概率。  

---------


某食肉动物2 于 2018-9-25 10:16:42 发表了：


> 
> 钟利时 发表于 2018-9-25 04:50
>   
> 
> 
> 我一直建议首先搞机电式计算机。  
> 
> 但我们初期可以在机电式计算机上开个金手指——用单片机实现机电计算机 ...
> 
  

zif同样可以用来接eefprom

---------


wizardtong 于 2018-9-25 12:37:55 发表了：


> 
> 
> 
> 钟利时 发表于 2018-9-25 04:50
> 
> 
>   
> 
> 我一直建议首先搞机电式计算机。  
> 
> 但我们初期可以在机电式计算机上开个金手指——用单片机实现机电计算机 ...
  

不知道临高什么时候可以生产磁带机，临高众年轻一点的都没见过纸带机，手动翻译机器码编程有点困难啊

---------


一路向上 于 2018-9-25 14:21:25 发表了：


> 
> wizardtong 发表于 2018-9-25 12:37
>   
> 
> 
> 不知道临高什么时候可以生产磁带机，临高众年轻一点的都没见过纸带机，手动翻译机器码编程有点困难啊 ...
> 
  

能写汇编，再努努力就能写机器码了。  

所以应该先问问有多少人写过汇编。

---------


thinostrich 于 2018-9-25 15:57:49 发表了：


> 
> 
> 
> 钟利时 发表于 2018-9-25 04:50
> 
> 
>   
> 
> 我一直建议首先搞机电式计算机。  
> 
> 但我们初期可以在机电式计算机上开个金手指——用单片机实现机电计算机 ...
  

几年前在大学很流行的S3C6410开发板就挺好，可以烧WINCE或者Linux，带SD卡。这样只要做一个串口的打印机和卡纸读写器就行。开发板上带几百兆的ROM和RAM，SD卡里可以存新开发的程序。当时一块板子1000块，带核心板、所有引出脚和4寸左右的触屏。  

如果要省钱就S3C2410，只能跑被裁的不成样子的Linux，但也支持SD卡和ROM/RAM，就是小点。  

再穷就是飞思卡尔的16位系列单片机，也是带SD卡的，就是只能用自带的几百K ROM/RAM了。我觉得是没必要带8位机的，接口板子都比芯片贵了，没必要省芯片的钱了。  

---------


thinostrich 于 2018-9-25 16:06:58 发表了：


> 
> 
> 
> 一路向上 发表于 2018-9-25 14:21
> 
> 
>   
> 
> 能写汇编，再努努力就能写机器码了。  
> 
> 所以应该先问问有多少人写过汇编。 ...
  

带过来的单片机和电脑的寿命应该是差不多的，所以我觉得大概率一直用高级语言用到带来的设备全挂了。就看那时候科技树能爬到什么程度了。C语言发明的时候8086都还没出来呢，全国有几百台“超级"电脑和上千套”超级“单片机应该够用到8086年代。只要别在电脑都挂掉了8086还没搞出来。这样就可以避开大规模使用打孔机、机器码时代。  

---------


wizardtong 于 2018-9-25 23:45:52 发表了：

 _本帖最后由 wizardtong 于 2018-9-25 23:57 编辑_   


> 
> 
> 
> 一路向上 发表于 2018-9-25 14:21
> 
> 
>   
> 
> 能写汇编，再努努力就能写机器码了。  
> 
> 所以应该先问问有多少人写过汇编。 ...
  

基本上学过单片机的都会用汇编吧，毕竟高级语言转化率太低，单片机又需要省资源。但机器码过分了啊，一代有几个愿意写这东西的，还有纸带，错了还得用胶布贴上再改。。。哪怕有磁带机用呢  

---------


wizardtong 于 2018-9-25 23:53:40 发表了：


> 
> 
> 
> 一路向上 发表于 2018-9-25 14:21
> 
> 
>   
> 
> 能写汇编，再努努力就能写机器码了。  
> 
> 所以应该先问问有多少人写过汇编。 ...
  

我感觉临高可能会有一个职业专门翻译机器码，就相当于抄录员什么的  

---------


钟利时 于 2018-9-26 19:18:27 发表了：


> 
> 
> 
> thinostrich 发表于 2018-9-25 16:06
> 
> 
>   
> 
> 带过来的单片机和电脑的寿命应该是差不多的，所以我觉得大概率一直用高级语言用到带来的设备全挂了。就看 ...
  

临高的计算机大致可以分为三条路线走，或者可以分为三个研究所：  

一所：维护已有的计算机，一直坚持到自制计算机出现。你说的那些开发板属于这个领域。  

（绝密机构，只有元老能接触的黑科技场所。）  

二所：从最基本的逻辑元件开始，重新设计制造数字计算机。从继电器逻辑电路开始。单片机是继电器计算机的理想化模型。同时也负责电报机、交换机。  

（对高学历规划民开放的场所。培养逻辑电路、数字计算机人才。）  

三所：该所研究“另一种计算机”。  

（绝密机构，有高学历规划民参加。该所产品可被欧洲工匠仿制，如泄露出去危害极大。所以该所保密程度比一所还高）  

  

---------


meicn 于 2018-9-26 20:47:59 发表了：

开个完全不好笑的笑话，这玩意的LCD和SD卡都是独立驱动的，这两个模块自带的驱动MCU芯片比这个CPU都强大……

---------


thinostrich 于 2018-9-27 11:53:36 发表了：


> 
> 
> 
> 钟利时 发表于 2018-9-26 19:18
> 
> 
>   
> 
> 临高的计算机大致可以分为三条路线走，或者可以分为三个研究所：  
> 
> 一所：维护已有的计算机，一直坚持到自 ...
  

4004集成了2000多晶体管，当前普通继电器的寿命是10万次开关。假如每执行一个周期有1000个继电器动作，运行100条指令就有一次预期故障得修。。。  

继电器计算机最多短时间取代机械计算器执行一些专用计算任务。  

用三极管硬拼一个4004还行，继电器不太靠谱吧。  

---------


没事乱溜达 于 2018-9-27 12:02:54 发表了：


> 
> meicn 发表于 2018-9-26 20:47
>   
> 
> 
> 开个完全不好笑的笑话，这玩意的LCD和SD卡都是独立驱动的，这两个模块自带的驱动MCU芯片比这个CPU都强大… ...
> 
  

原来这样。。

---------


lzy0702 于 2018-9-29 12:27:42 发表了：


> 
> 
> 
> 钟利时 发表于 2018-9-26 06:18
> 
> 
>   
> 
> 临高的计算机大致可以分为三条路线走，或者可以分为三个研究所：  
> 
> 一所：维护已有的计算机，一直坚持到自 ...
  

原时空的计算机不作死的话，用个二十年是可以的，再加上储备，坚持40~50年不应该成为问题。现在同人文里各种10年不到就连大图书馆的资料都要蒸发的潮流是有偏差的。  

计算机的知识应该算是公开得最好的一类了，绝大多数标准和协议都明明白白写了定义，复现起来有据可依。指令集这东西是可以查的，实现出来和原时空一样就行，IPC之类的效率可以先放放，能把原时空的软件跑起来就是很大胜利了。我觉得CPU部分都还好说，资料普遍比较全，那些需要GPU的部分问题很大  

---------


